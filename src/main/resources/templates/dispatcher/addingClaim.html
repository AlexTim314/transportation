<div class="menu-new-claim" id="form-add"  xmlns:th="http://www.thymeleaf.org">
    <i class="fas fa-times" onclick="menu_close()"></i>
    <form action="#" method="POST">
        <section class="section-type">
            <div class="form-item">

            </div>
            <div class="form-item clearfix" >

                <div class=" left-block">
                    <label for="type">Марка авто</label>
                    <select name="type" ng-options="m as m.modelName for m in plctrl.vehicleModels track by m.id" ng-model="plctrl.addDispatcherClaim.appointment.vehicleModel" ng-change="plctrl.filteringVehicles(plctrl.addDispatcherClaim.appointment.vehicleModel)">
                        <option value="" disabled selected>Выберите Марку</option>	
                    </select>
                </div>


                <div class="right-block" >
                    <label for="criterion">Гос.номер</label>
                    <select name="criterion" ng-options="n.id as n.number for n in plctrl.vehicles|filter: {model: {id: plctrl.addDispatcherClaim.appointment.vehicleModel.id}} track by n.id"   ng-model="plctrl.addDispatcherClaim.vehicleId">
                        <option value="" disabled selected>Выберите Гос.Номер</option>
                    </select>	
                </div>	
            </div>
            <div class="form-item clearfix">
                <label for="driver">Водитель</label>
                <select name="driver" ng-options="d.id as plctrl.personToString(d) for d in plctrl.drivers track by d.id"   ng-model="plctrl.addDispatcherClaim.driverId">
                    <option value="" disabled selected>Выберите Водителя</option>					
                </select>
            </div>    




            <div class="form-item check-hidden">
                <label for="purpose">Цель</label>
                <textarea name="purpose"   rows="10" ng-model="plctrl.addDispatcherClaim.purpose" style="resize: vertical;"></textarea>
            </div>
            <div class="form-item block-route" >
                <div class="left-block-route">
                    <label for="carBoss">Старший</label>
                    <select name="carBoss" ng-options="cb.id as plctrl.carBossToString(cb) for cb in plctrl.carBosses|filter: {department : {id: plctrl.department.id}} track by cb.firstname" ng-model="plctrl.addDispatcherClaim.carBossId" required>
                        <option value="" disabled selected>Выберите старшего машины</option>
                    </select>
                </div>
                <div class="right-block-route">
                    <div class="btn edit"  onclick="formOpen('dispatcherCarBoss')" title="Добавить старшего"><i class="fas fa-lg fa-user" ></i></div> 						 		
                </div>

            </div>

            <div class="form-item check-hidden block-route">

                <div class="left-block-route">
                    <label for="route">Маршрут</label>
                    <select name="route" ng-options="route.routeTasks as route.name for route in plctrl.routeTemplates track by route.id" ng-model="plctrl.addDispatcherClaim.routeTasks">
                    </select>  
                </div>
                <div class="right-block-route">
                    <div class="btn edit"  onclick="formOpen('dispformTask')" title="Добавить задачи"><i class="fas fa-lg fa-tasks" ></i></div> 						 		
                </div>
            </div>	
        </section>

        <section>	 
            <div class="form-item clearfix" >

                <div class="form-item-date ">
                    <label for="date-begin">Дата</label>
                    <label class="custom-checkbox">
                        <input type="checkbox" ng-model = "plctrl.onWeek">на неделю
                        <span class="checkmark"></span>
                    </label>

                    <div class="inp-btn clearfix">
                        <input type="date"  name="date-begin" ng-model="plctrl.startDate" id="startDate" required >
                        <span title="Добавить дату" class="fas fa-lg fa-plus-circle" ng-click = "plctrl.addRec()"></span>
                    </div>							 		
                </div>



                <div class="right-block ">
                    <label for="time-begin">Время выезда</label>
                    <input type="time"  name="time-begin" ng-model="plctrl.newRecord.startDate" id="startTime" required>


                    <label for="time-begin">Время возвращения</label>
                    <input type="time"  name="time-begin" ng-model="plctrl.newRecord.endDate" id="endTime" required>

                    <div class="check-hidden">
                        <label class="custom-checkbox">
                            <input type="checkbox" id="other-day-check" onchange="checkShow('other-day', 'other-day-check')" ng-model="plctrl.isOtherDay">другой день
                            <span class="checkmark" title="установить дату возвращения на следующий день"></span>
                        </label>
                        <div class="btn edit right-calendar" id="other-day" title="Выбрать дату"><i class="fas fa-lg fa-calendar-alt"></i></div>
                    </div>

                </div>
                <div class="left-block-tag">
                    <div class="route-tag {{rec.checked?'active-color':''}}" ng-repeat="rec in plctrl.addDispatcherClaim.dates| orderBy:'startDate'" ng-click="plctrl.checkRecord(rec)">{{rec.startDate| date:'dd.MM.yyyy'}}
                        <span class="fas fa-times" ng-click = "plctrl.removeRec(rec)"></span>
                    </div>

                </div>
            </div> 					

        </section>


        <div class="form-item">
            <button class="btn submit" id="btn-add-edit" ng-click="plctrl.submitClaim()">Добавить</button>
        </div>

    </form>
    <div class="new-claim-task" id="dispatcherCarBoss" style=" width: 40%;min-width: 400px;">
        <i class="fas fa-times i-close" onclick="formClose('dispatcherCarBoss')"></i>

        

            <div class="form-item" style="margin-top:30px;">
                <label for="dsurname">Фамилия</label>
                <input type="text" class="letter-mask" name="dsurname" ng-model="plctrl.carBoss.firstname" title="Только буквы русского алфавита">
            </div>
         
            <div class="form-item" >    
                <label for="dfirstname">Имя</label>
                <input type="text" class="letter-mask" name="dfirstname" ng-model="plctrl.carBoss.name" title="Только буквы русского алфавита">
            </div>
            <div class="form-item" >    
                <label for="dsecondname">Отчество</label>
                <input type="text" class="letter-mask" name="dsecondname" ng-model="plctrl.carBoss.surname" title="Только буквы русского алфавита">
            </div>
            <div class="form-item" >    
                <label for="number">Должность</label>
                <input type="text" name="number" ng-model="plctrl.carBoss.post">
            </div>
            <div class="form-item" >
                <label for="phone">Номер мобильного</label>
                <input type="tel" name="phone" ng-model="plctrl.carBoss.phone">
            </div>  
        <div class="form-item"> 
            <div class="left-block" style="margin-top:10px;">	
                <div ng-show="plctrl.carBoss.id !== null" class="btn delete" ng-click="plctrl.resetCBForm()">Сброс</div>
            </div>

            <div class="right-block" style="margin-top:10px;">	
                <div class="btn edit" ng-click="plctrl.submitCB()"><i class="{{plctrl.carBoss.id===null?'fas fa-plus-circle':'fas fa-edit'}}" style="cursor:pointer;" ></i>{{plctrl.carBoss.id===null?'Добавить':'Изменить'}}</div>
            </div>
        </div>
        <div class="small-height-wrapper">	
            <table class="table-task" >
                <tr>
                    <th>ФИО</th>
                    <th>Должность</th>
                    <th>Номер мобильного</th>
                    <th></th>
                </tr>
                <tr ng-repeat="b in plctrl.carBosses| orderBy: 'fullname'|filter: {department : {id: plctrl.department.id}}">
                    <td>{{b.firstname}} {{b.name[0]}}.{{b.surname[0]}}.</td>
                    <td>{{b.post}}</td>
                    <td>{{b.phone}}</td>
                    <td>
                        <span class="fas fa-times" ng-click="plctrl.removeCB(b)"></span>
                        <span class="fas fa-edit" ng-click="plctrl.tryToUpdateCB(b)"></span>
                    </td>	 					
                </tr>	 				
            </table>
        </div>
        <div class="form-item">
            <div class="right-block">	
                <div class="btn edit" onclick="formClose('dispatcherCarBoss')"><i class="fas fa-save"></i>Сохранить</div>
            </div>    
        </div>
    </div>
    <div class="new-claim-task" id="dispformTask">
        <i class="fas fa-times i-close" onclick="formClose('dispformTask')"></i>
        <!-- <div class="height-wrapper"> -->
        <div class="form-item" style="margin-top:30px;">
            <label for="type">Место</label>
            <select name="type" ng-options="p as p.name + (p.address !== null ? ' (' + p.address + ')' : '') for p in plctrl.places| orderBy: 'name'|filter:pFilt track by p.id" ng-model = "plctrl.routeTask.place">
                <option value="" disabled selected><--Выберите место--></option>
            </select>
        </div>	
        <div class="form-item" style="margin-bottom:20px;"> 

            <label for="work">Работы</label>
            <textarea name="work" ng-model="plctrl.routeTask.workName"></textarea>

            <div class="left-block" style="margin-top:10px;">	
                <div ng-show="plctrl.routeTask.id !== null" class="btn delete" ng-click="plctrl.resetRTaskForm()">Сброс</div>
            </div>

            <div class="right-block" style="margin-top:10px;">	
                <div class="btn edit" ng-click="plctrl.submitRTask()"><i class="{{plctrl.routeTask.id===null?'fas fa-plus-circle':'fas fa-edit'}}" style="cursor:pointer;" ></i>{{plctrl.routeTask.id===null?'Добавить':'Изменить'}}</div>
            </div>
        </div>
        <div class="small-height-wrapper">	
            <table class="table-task" >
                <tr>
                    <th>Место</th>
                    <th>Задание</th>
                    <th></th>
                </tr>
                <tr ng-repeat="routeTask in plctrl.rec.routeTasks| orderBy: 'orderNum'">
                    <td>{{routeTask.place.name}}</td>
                    <td>{{routeTask.workName}}</td>
                    <td>
                        <span class="fas fa-times" ng-click="plctrl.removeRTask(routeTask)"></span>
                        <span class="fas fa-edit" ng-click="plctrl.tryToUpdateRTask(routeTask)"></span>
                    </td>	 					
                </tr>	 				
            </table>
        </div>
        <div class="form-item">
            <div class="right-block">	
                <div class="btn edit" onclick="formClose('dispFormTask')"><i class="fas fa-save"></i>Сохранить</div>
            </div>    
        </div>

    </div>
</div>
